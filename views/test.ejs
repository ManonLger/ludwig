<html>
<head>
    <meta charset="utf-8">
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <script type="text/javascript" src="bower_components/jquery/dist/jquery.min.js" charset="utf-8"></script>

</head>
<body>
<script type="text/javascript" src="http://localhost:3000/bundle.js" charset="utf-8">
</script>
<script>
    var configuration = {
        repoUrl: 'https://github.com/hoshin/git-api-tests/new/master',
        template: 'some+basic+template',
        prefix: 'test-ludwig',
        expectedTemplate: '{\r\n\tdata:"123"\r\n\ttoBe:{\r\n\t\tused:1, \r\n\t\tas:"template for expected state"\r\n\t}\r\n}',
        ludwigCreateSuggestionURL: 'http://localhost:3000/createSuggestion',
        web: {
            acceptedTestsPath: '/tree/master/tests',
            addPath: '/new/master',
            suggestedTestsPath: '/pulls?utf8=✓&q=is%3Apr+is%3Aopen'
        },
        commitReferenceToBranchFrom: '48bb6a551021348274d7a16fb370278d1b491668'
    }

    var ludwig = new Ludwig(configuration)
</script>
<script>
    var currentState = {
        step1: {selected: 'field1', value: 1234},
        step2: {checked: 'selection', value: [1, 'deux', {trois: 4}]},
        step3: {filled: 'demande_situation_detail', value: 'Ceci est un texte libre'},
        step4: {clicked: 'simulation', value: null}
    }

    function createLink() {
        var suggestionLink = ludwig.generateSuggestionURL(currentState)
        var elementContainer = document.getElementById('linkContainer')
        elementContainer.setAttribute('href', suggestionLink)
        elementContainer.innerText = suggestionLink
    }

    function createSuggestion() {
        window.open(ludwig.generateSuggestionURL(currentState))
    }

    function showAcceptedTests() {
        window.open(ludwig.acceptedTestsURL())
    }

    function showSuggestedTests() {
        window.open(ludwig.suggestedTestsURL())
    }

    function createCompleteSuggestion() {
        window.location = ludwig.generateLudwigSuggestionEndpointURL($("#title").val(), $("#description").val(), currentState, $("#expected").val())
    }
    $(function () {
        $("#expected").val(ludwig.expectedTemplate)
    })
</script>

</a>
</body>

<body>

<!-- Begin page content -->
<div class="container">
    <h2>Page de démonstration de Ludwig et de son widget navigateur</h2>
    <div>
        <h4>Diverses actions possibles en passant directement par le widget (pas besoin du backend Ludwig) :</h4>
        <div class="form-group row">
            <input type="button" class="btn btn-default col-sm-6"
                   value="Générer un lien vers une nouvelle suggestion : ludwig.generateSuggestionURL()"
                   onclick="createLink()"/>
            <a class="col-sm-6" href="" id="linkContainer">
            </a>
        </div>
        <div class="form-group row">
            <input type="button" class="btn btn-default col-sm-6"
                   value="Créer la suggestion + rediriger l'utilisateur : ludwig.generateSuggestionURL()"
                   onclick="createSuggestion()"/>
        </div>
        <div class="form-group row">
            <input type="button" class="btn btn-default col-sm-6"
                   value="Aller à la page contenant les tests acceptés : ludwig.acceptedTestsURL()"
                   onclick="showAcceptedTests()"/>
        </div>
        <div class="form-group row">
            <input type="button" class="btn btn-default col-sm-6"
                   value="Aller à la page contenant les tests suggérés : ludwig.suggestedTestsURL()"
                   onclick="showSuggestedTests()"/>
        </div>
    </div>
    <div>
        <h4>Appels à l'API GitHub (nécessite de passer par le backend Ludwig):</h4>
        <div class="form-group row">
            <label class="col-sm-3" for="title">Titre</label>
            <input class="col-sm-3" type="text" id="title" name="title"/>
        </div>
        <div class="form-group row">
            <label class="col-sm-3" for="description">Description</label>
            <textarea class="col-sm-3" type="text" id="description" name="description"></textarea>
        </div>
        <div class="form-group row">
            <label class="col-sm-3" for="description">Données attendues</label>
            <textarea class="col-sm-3" type="text" id="expected" name="expected">

            </textarea>
        </div>
        <div class="form-group row">
            <input type="button" class="btn btn-default" value="Créer un ticket complet"
                   onclick="createCompleteSuggestion()"/>
        </div>
    </div>
</div>

<footer class="footer">
    <div class="container">
        <p class="text-muted"></p>
    </div>
</footer>

</body>

</html>

